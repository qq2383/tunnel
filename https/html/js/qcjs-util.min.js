/* ! qcjs (c) 老李 (20390965@qq.com) v0.2.3 */
qc.c={},qc.icon={},qc.lang={},qc.util={_mobile:!1,_starts:[],_inited:[],init:function(){if(0==arguments.length){var t,e=[];for(t in qc.util.on(),qc.c){var c=qc.c[t];qc[t]=c,e.push(c)}qc.util.setIconStyle(),qc.util.starts(),qc.util.langInit(function(){qc.util.creates(e),qc.util.initeds(e)})}else for(var a=0;a<arguments.length;a++){var r=qc(arguments[a]);(c=qc.util.convert2fnc("qc."+r.attr("qc-control")+".create"))&&c(r)}},convert2fnc:function(t){var e;try{"string"==typeof t?t.match(/^[\w\d_\$\.]+$/)&&(e=Function("return ("+t+")")()):"object"==typeof t&&t.attr("qc-fn")?e=qc.util.convert2fnc(t.attr("qc-fn")):"function"==typeof t&&(e=t)}catch(t){}return e},fnc:function(t){var e=!0,c="string"==typeof t?t:t.fn,c=qc.util.convert2fnc(c),t="object"==typeof t?{contrl:t.contrl,curr:t.curr,ev:t.ev}:t;return e=c?c(t):e},on:function(){qc.util.mobile();var t=qc(document);t.on("click",qc.util.event),t.on("change",qc.util.event),qc(window).on("resize",qc.util.resize),qc(window).on("load",qc.util.resize)},start:function(t){"function"==typeof t&&qc.util._starts.push(t)},creates:function(t){t.each(function(t){t.create&&(t.control?qc("[qc-control='"+t.control+"']").each(function(){t.create(qc(this))}):t.create())})},addInited:function(t){"function"==typeof t&&qc.util._inited.push(t)},initeds:function(t){t.push.apply(t,qc.util._inited),t.each(function(t){t.init?t.init():"function"==typeof t&&t()})},starts:function(){qc.util._starts.each(function(t){t()})},event:function(t){var e=!0,c=("change"==t.type&&qc.util.getVal(qc(t.target)),qc.util.find(qc(t.target),t));return c.fn&&(e=qc.util.fnc(c)),qc.util.hideObj.remove(t),e},find:function(t,e){var c=t.closest("[qc-control]"),a=t,r=a.attr("qc-fn"),t=a.attr("qc-for"),n=e.type.toLowerCase(),i=a.attr("qc-type"),o=QCSet();if("change"==n&&o.add(n),i&&(i=i.trim(),o.add(i.split(/\s+/))),t&&"change"!=n)r="qc."+t+".show";else{for(;0==o.length&&!r&&0!=(a=a.parent()).length;)a.attr("qc-type")&&o.add(a.attr("qc-type")),r=a.attr("qc-fn");0<o.length&&r?r=o.contains(n)?r:"":0<c.length&&0<o.length&&!r&&("change"!=(i=o[0])||"change"==i&&n==i)&&(r="qc."+c.attr("qc-control")+"."+o[0])}return{contrl:c,curr:a,fn:r,ev:e}},hideObj:{hides:QCSet(),set:function(){for(var t=[],e=0;e<arguments.length;e++)t.push(arguments[e]);qc.util.hideObj.hides.add(t)},remove:function(c){qc.util.hideObj.hides.each(function(t){var e=!1;t.each(function(t){t=qc(t);e=e||c.pageX>=t.offset().left&&c.pageX<=t.offset().left+t.width()&&c.pageY>=t.offset().top&&c.pageY<=t.offset().top+t.height()}),e||(qc(t[0]).hide(),qc.util.hideObj.hides.remove(t))})}},resize:function(){qc.util.mobile()},mobile:function(){var t,e=!1;e="maxTouchPoints"in navigator?0<navigator.maxTouchPoints:"msMaxTouchPoints"in navigator?0<navigator.msMaxTouchPoints:(t=window.matchMedia&&matchMedia("(pointer:coarse)"))&&"(pointer:coarse)"===t.media?!!t.matches:"orientation"in window||(t=navigator.userAgent,/\b(BlackBerry|webOS|iPhone|IEMobile)\b/i.test(t))||/\b(Android|Windows Phone|iPad|iPod)\b/i.test(t),qc.util._mobile=e},isMobile:function(){return qc.util._mobile},getFields:function(e,t,c){c=c||{},t?t.split(",").each(function(t){t=t.trim();t=e.attr(t);t&&t.split(",").each(function(t){t=t.trim(),qc.util.getVal(e.find("[qc-field='"+t+"']"),c)})}):e.find("[qc-field]").each(function(){qc.util.getVal(qc(this),c)});var t=QCSet(c.key),a=e.attr("qc-key");return a&&t.add(a.split(",")),c.key=t.join(","),c},getVal:function(t,e){var c,a,r,n,i=void 0;return t[0]&&(a=t[0].tagName.toLowerCase(),a=t.attr("type")||a,c=t.attr("qc-field"),n=qc[t.attr("qc-control")],["hidden","text","password","select","textarea"].contains(a)?(i=t.val(),t.attr("qc-value",i)):i=["checkbox","radio"].contains(a)?t.is(":checked")?t.val():t.attr("qc-default"):"file"==a?t[0]:n&&n.val?n.val(t):((a=t.find("[qc-subfield]"))[0]&&(r=[],a.each(function(){var t=qc(this).attr("qc-value");r.push(t)}),t.attr("qc-value",r.join("&"))),t.attr("qc-value")),e)&&c&&null!=i&&((n=e[c])?Array.isArray(n)?n.contains(i)||n.push(i):i&&n!=i&&(e[c]=[n,i]):e[c]=i),i},setDatas:function(t,c){var e=t.find("[qc-field]");(e=e[0]?e:t).each(function(){var t=qc(this),e=t.attr("qc-field"),e=c[e]||t.attr("qc-default")||"";qc.util.setData(t,e)})},setData:function(t,e,c){null==c&&(c=e,e=void 0);var a,r=e?t.find("[qc-field='"+e+"']"):t;r[0]&&(r.attr("qc-value",c),r.is("[qc-control='selector']")?qc.selector.val(r,c):r.is("[type='checkbox']")||r.is("[type='radio']")?c==r.attr("qc-default")?(r.removeAttr("checked"),r[0].checked=!1):(r.attr("checked","checked"),r[0].checked=!0):(e=r.attr("type")||r[0].tagName.toLowerCase(),["hidden","text","password","select","textarea"].contains(e)?r.val(c):(a=(c+"").split("&")).each(function(t){t=decodeURI(decodeURI(t)),1==a.length?r.html(t):r.append("<span qc-subfield qc-value='"+t+"'>"+t+"</span>")})))},setDefualt:function(t,e,c){var a,r={};for(a in"object"==typeof e?r=e:r[e]=c,r){var n=t.find("[qc-field='"+a+"']");n[0]&&(n.attr("qc-default",r[a]),n.removeAttr("qc-value"),n[0].value?n.val(""):n.is("[qc-control='selector']")?qc.selector.val(n,""):n.html(""))}},initData:function(c,t){c.find("[qc-field]").each(function(){var t=qc(this).attr("qc-default"),e=qc(this).attr("qc-field");null!=t&&qc.util.setData(c,e,t)})},get:function(t,e,c){qc.util.postData("qc-get",t,e,c)},post:function(t,e,c){qc.util.postData("qc-post",t,e,c)},upload:function(t,e,c){qc.util.postData("qc-upload",t,e,c)},postData:function(t,e,c,a){"function"==typeof c&&(a=c,c={});var r=qc.util.parseArgs(t,e,c),t=r.fn;t&&("string"==typeof t?qc._post(t,c,function(t){qc.util.postBack(t,r.re,a)}):t(r.re,function(t){qc.util.postBack(t,r.re,a)}))},parseArgs:function(t,e,c){var a,r,n,i;return"string"==typeof e?n=qc.util.convert2fnc(e)||e:(i="qc-key, qc-need",(r=(a=(e=e).closest("[qc-control]")).parent().closest("[qc-control]"))[0]&&qc.util.getFields(r,i,c),a[0]&&qc.util.getFields(a,i,c),qc.util.getVal(e,c),e.attr(t)?n=e.attr(t):a[0]&&a.attr(t)?n=a.attr(t):r[0]&&r.attr(t)&&(n=r.attr(t)),n=qc.util.convert2fnc(n)||n,i={contrl:a,curr:e,args:c}),{fn:n,re:i}},postBack:function(t,e,c){try{t=JSON.parse(t)}catch(t){}c&&c(t,e)},setLangDir:function(t){qc.util._langDir=t},getLangDir:function(){return qc.util._langDir},setLangGlobal:function(t){t&&(qc.util._langGlobal=t)},getLangGlobal:function(){return qc.util._langGlobal},setLangName:function(t){qc.util._langName=t},getLangName:function(){return qc.util._langName},langInit:function(t,e){"function"==typeof t&&(e=t,t=void 0),qc.util._langDir||(qc.util._langDir=qc("html").attr("qc-lang-dir")||"lang"),qc.util._langName=t||qc("html").attr("lang"),qc.util.langGlobal(function(){var t;qc.util._langName?((t=qc.util._langName).match(/.*\.js$/)||(t+=".js"),t=qc.util._langDir+"/"+t,qc.getScript(t,function(){qc.util.langReset(),e&&e()})):e()})},langGlobal:function(t){var e;qc.util._langGlobal||(qc.util._langGlobal=qc("html").attr("qc-lang-global")),qc.util._langGlobal?((e=qc.util._langGlobal).match(/.*\.js$/)||(e+=".js"),e=qc.util._langDir+"/"+e,qc.getScript(e,t)):t()},lang:function(e,t,c,a){c=c||"title",a||(n=e.closest("[qc-control]"))[0]&&(a=n.attr("qc-control"));var r,n=qc.lang[a];n&&(r=n[t]||t)&&(!c&&e.val?e.val(r):c.split(",").each(function(t){"html"==(t=t.trim())?e.html(r):e.attr(t,r)}))},langReset:function(){qc("[qc-lang]").each(function(){var t=qc(this),e=t.attr("qc-lang"),c=t.attr("qc-lang-name"),a=t.attr("qc-lang-attr");qc.util.lang(t,c,a,e)})},icon:function(t,e,c){c||(a=t.closest("[qc-control]"))[0]&&(c=a.attr("qc-control"));var a=qc.icon[c];a&&(c=a[e]||e)&&(qc.iconStyle?t.prepend(qc(qc.iconStyle).addClass(c)):t.addClass(c))},setIconStyle:function(t){qc.iconStyle=t||"<i class='fa'>"}},qc(function(){qc.util.init()}),qc.c.popfrm={control:"popfrm",create:function(t){var e,c,a,r,n,i,t=qc(t);0!=t.length&&(t.hide(),e=t.find("[qc-warp]"),c=t.find("[qc-container]"),a=t.find("[qc-content]"),r=t.attr("qc-buttons"),n=t.attr("qc-title"),i=t.attr("qc-content"),0==e.length&&(e=qc("<div class='qc-warp' qc-warp>"),t.prepend(e)),0==c.length&&(c=qc("<div class='qc-container' qc-container>"),t.append(c)),(r||n)&&qc.popfrm.createToolbar(n,r,c),0==a.length&&(a=qc("<div class='qc-content' qc-content>"),c.append(a)),i&&a.html(i),0==c.find("[qc-buttons] a").length)&&e.attr("qc-type","hide")},show:function(t){var t=t.curr,e=qc(t.attr("qc-target")),c=t.attr("qc-fn"),a=t.attr("qc-post");if(e[0]){e[0].origin=t,e[0].isHide=!0,a&&(e[0].hideCallee=qc.util.convert2fnc(a)),e.show();var r=qc.util.convert2fnc(c);r&&r(e),qc.popfrm.layout(e)}else{for(var r=t.attr("qc-title"),e=t.attr("qc-buttons"),n=t.contents(),i=t.attr("qc-content")||"",o=n[0];o;)8==o.nodeType&&(i+=o.textContent+"\n"),o=o.nextSibling;qc.popfrm.dyShow(r,e,i,t,c,a)}},dyShow:function(t,e,c,a,r,n){var i=qc("<div class='qc-popfrm' qc-control='popfrm'>"),o=qc("<div class='qc-container' qc-container>"),d=qc("<div class='qc-warp' qc-warp>");qc("body").append(i),i.append(d).append(o);0==qc.popfrm.createToolbar(t,e,o)&&d.attr("qc-type","hide");t=qc("<div class='qc-content' qc-content>");o.append(t),"object"==typeof c&&c.src&&(i[0].src=c.src,t.addClass("qc-popfrm-iframe"),t.append("<iframe src='"+c.src+"'>")),"string"==typeof c&&t.append(c),i[0].origin=a,i[0].isHide=!1,n&&(i[0].hideCallee=n),i.show(),r&&r(i),qc.popfrm.layout(i)},createToolbar:function(t,e,c){var a=c.find("[qc-toolbar]"),r=0;return(t||e)&&(a[0]||(a=qc("<div class='qc-toolbar' qc-toolbar>"),c.prepend(a)),(c=a.find("[qc-title]"))[0]||(c=qc("<span class='qc-title' qc-title>"),a.append(c)),t=t||qc.lang.popfrm.title,c.html(t),r=qc.popfrm.createButtons(e,a)),r},createButtons:function(t,e){var c,a,r,n;return t?(c={cancel:{title:qc.lang.popfrm.cancel,icon:"close",text:"",type:"hide"},ok:{title:qc.lang.popfrm.ok,icon:"ok"}},a=[],r=c.cancel,("string"==typeof t?t.split(" "):t).each(function(t){var e;"object"==typeof(t="string"==typeof t&&"cancel"!=t?c[t]:t)&&(e=t.name,t=qc._extend(t,c[e]),"cancel"==e?r=t:a.push(t))}),a.push(r),0<a.length&&((n=e.find("[qc-buttons]"))[0]||(n=qc("<div class='qc-buttons' qc-buttons>"),e.append(n),n.empty()),a.each(function(t){var e=qc("<a href='javascript:void(0);'>");n.append(e),t.name&&e.attr("qc-button-name",t.name),e.attr("qc-type",("cancel"!=t.name||!t.fn)&&t.type||""),qc.util.lang(e,t.title,"title"),t.fn&&e.attr("qc-fn",t.fn),t.text&&(qc.util.lang(e,t.text,"html"),e.prepend("&nbsp;")),t.icon&&qc.util.icon(e,t.icon),t.title&&e.attr("title",t.title)})),a.length):0},hide:function(t){t.contrl[0].hideCallee&&t.contrl[0].hideCallee(t),qc.popfrm.hidden(t.contrl)},hidden:function(t){t[0].isHide?t.hide():t.remove()},layout:function(e){var t,c,a,r,n=e[0].origin,i=e[0].ownerDocument.documentElement,o=e.find("[qc-container]"),d=e.find("[qc-warp]"),l=e.find(".qc-popfrm-iframe"),s="absolute";!n||e[0].src?(r=t="5%",a=c="15%"):qc.util.isMobile()?(s="relative",c=d.height()/2-o.height()/2+"px"):n[0]&&(c=n.offset().top+n.height()-i.scrollTop,t=n.offset().left,c>d.height()/2&&(c=c-o.height()-n.height()),t>d.width()/2&&(t-=o.width()),c+="px",t+="px"),o.css({position:s,top:c||"auto",left:t||"auto",right:r||"auto",bottom:a||"auto"}),l[0]&&l.css("height","calc(100% - "+e.find(".qc-toolbar").outerHeight()+"px"),e.attr("tabindex",0),e.focus(),e.on("keyup",function(t){if("Escape"==t.key)return qc.popfrm.hide({contrl:e}),!1})}},qc.c.selector={control:"selector",create:function(t){t=qc(t);0!=t.length&&qc.selector.createBox(t)},createBox:function(e){var c=qc("<div>");if(e[0].getAttributeNames)e[0].getAttributeNames().each(function(t){c.attr(t,e.attr(t))});else for(var t=e[0].attributes,a=0;a<t.length;a++)c.attr(t[a].name,t[a].value);e.before(c),c.addClass("qc-selector"),c.attr("qc-type","show"),qc.selector.initData(c,e);var r=qc("<input type='text' class='qc-selector-text' qc-content readonly>"),n=qc("<a href='javascript:void(0);' class='qc-selector-caret'></a>"),i=qc("<ul qc-selector-list>"),o=(c.append(n).append(r).append(i),c.attr("qc-title")),d=c.attr("qc-icon"),n=(r.attr("title",o||""),qc.util.icon(n,d||"caret"),c.attr("qc-mode")||"auto");c[0].mode=n.contains("normal")?"":"auto",n.contains("search")?(c[0].seMode="search",c[0].search=""):c[0].seMode="",c[0].seMode&&(r.attr("placeholder",o||""),r.removeAttr("readonly"),r.change(function(t){return!1})),r.attr("qc-type","show"),i.hide(),c.on("keyup",qc.selector.keyup)},initData:function(t,e){var r=[],n=t.attr("qc-field")||"v",i=t.attr("qc-text")||n;e.find("option").each(function(){var t=qc(this),e=t.text(),c=!0,a={};a[n]=t.attr("value"),e.split(",").each(function(t){t=t.trim();t=/^([^=]+)=(.+)$/.exec(t);t&&(a[t[1]]=t[2],c=!1)}),c&&(a[i]=e),r.push(a)}),t[0].data={rows:r.length,data:r},e.remove()},init:function(){qc.selector.getDatas()},getDatas:function(e){var t,c=e?(t=e.filter("[qc-for]"),e):(t=qc("[qc-control='selector'][qc-for]"),qc("[qc-control='selector']"));t.each(function(){var t=qc(this),e=qc(t.attr("qc-for"));t[0].frEl=e[0],e[0].orEl=t[0]}),c.each(function(){var t;this.orEl||!e&&"auto"!=this.mode||(t=qc(this),qc.selector.getData(t))})},getData:function(t,e){var c={};t[0].orEl&&qc.util.getVal(qc(t[0].orEl),c),t[0].search&&(c[t.attr("qc-search-key")||"search_key"]=t[0].search),qc.selector.get(t.attr("qc-get"),t,c,e)},get:function(t,e,c,a){var r;t?(r=e.attr("qc-get"),e.attr("qc-get",t),c.count=e.attr("qc-count")||0,c.page=c.count?1:0,qc.util.get(e,c,function(t){e.attr("qc-get",r),e[0].data=t,qc.selector.fillData(e,a)})):qc.selector.fillData(e,a)},fillData:function(t,e){t.find("ul").empty();for(var c=t[0].data,a=t.attr("qc-field")||"v",r=(t.attr("qc-text")||a).split(","),n=(t.attr("qc-buttons")||"").split(","),i=t.find("ul"),o=0;o<c.rows;o++){var d=c.data[o],l=[],s=[],q=(r.each(function(t){t=t.trim();var e=d[t];l.push(null==e?t:e)}),n.each(function(t){var t=t.split("|"),e=t[0],c=t[1],a=t[3],r=t[2];if(1==t.length&&!e)return!0;t=qc("<a href='javascript:void(0);' class='qc-button'>"+e+"</a>");c&&qc.util.icon(t,c,"selector"),r&&t.attr("title",r),a&&t.attr("qc-fn",a),s.push(t)}),l.join(" ")),f=qc("<li tabindex='"+o+"'>"+q+"</li>");f.attr("qc-value",d[a]),f.attr("qc-text",q),f.attr("qc-type","select"),0<s.length&&((q=qc("<div class='qc-buttons'>")).append(s),f.append(q)),i.append(f)}var p=t.attr("qc-default"),u=t.find("li"),h=u.filter("[qc-value='"+p+"']");null==p&&null==t[0].search&&(h=u.eq(0)),qc.selector.selected({contrl:t,curr:h}),e?e(t):(p=qc.util.convert2fnc(t.attr("qc-fn")))&&p(t)},show:function(t,e){var c=t.contrl||t;e?(c[0].data=e,qc.selector.fillData(c),qc.selector.shown(c)):c[0].seMode?(t.curr=c.find("[qc-content]"),qc.selector.search(t,qc.selector.shown)):qc.selector.shown(c)},shown:function(t){var e=t.find("ul"),t=(e.show(),qc.util.hideObj.set(e,t),e.css({left:"0px",top:t.height()+"px","min-width":t.width()+"px"}),e.find("li.selected"));0<t.length&&(e[0].scrollTop=t[0].offsetTop)},select:function(t){qc.selector.selected(t);var e=t.contrl.find("ul");qc.util.hideObj.hides.each(function(t){t[0].equals(e)&&(e.hide(),qc.util.hideObj.hides.remove(t))}),qc.selector.change(t)},selected:function(t){var e=t.contrl,c=t.curr,a=c[0]?c.attr("qc-text"):"",r=c[0]?c.attr("qc-value"):"";e.find("li").removeClass("selected"),c[0]&&(c.addClass("selected"),e.find("[qc-content]").val(a)),e.attr("qc-value",r),e[0].seMode&&!t.ev||qc.selector.for(e)},change:function(c,a){qc.selector.post(c.contrl,function(t){var e=c.contrl.closest("[qc-control='editor']");0<e.length?qc.editor.change({contrl:e,curr:c.contrl},a):a&&a(t,c)})},post:function(t,c){t.attr("qc-post")&&qc.util.post(t,function(t,e){c&&c(t,e)})},for:function(t){var t=t.attr("qc-for");t&&((t=qc(t)).find("[qc-content]").val(""),qc.selector.getData(t))},search:function(t){var e=t.contrl||t,t=t.curr||t.find("[qc-content]");e[0].search=t.val(),qc.selector.getData(e,qc.selector.shown)},val:function(t,e){var c;return null==e?e=t.attr("qc-value"):(e||t[0].search||(t[0].search=void 0),(c=t.find("li[qc-value='"+e+"']"))[0]?qc.selector.selected({contrl:t,curr:c}):t[0].seMode&&(t.attr("qc-value",e),t.find("[qc-content]").val(e))),e},text:function(t,e){if(null==e)return t.find("[qc-content]").val();t.find("[qc-content]").val(e)},addItem:function(t,e,c){var a,r=(t="string"==typeof t?qc(t):t)[0].data,n=r.data;Array.isArray(e)?n=n.concat(e):((a={})[t.attr("qc-field")]=e,a[t.attr("qc-text")]=c,n.push(a)),r.data=n,r.rows=n.length,qc.selector.getDatas(t)},removeItem:function(t,e){var c=[],e=(Array.isArray(e)?c=c.concat(e):c.push(e),t[0].data),a=e.data;c.each(function(t){a.splice(t,1)}),e.rows=a.length},focus:function(t){t.find("[qc-content]").focus()},keyup:function(t){var e,c,a=qc(this),r=qc(t.target),n=t.key;r.is("[qc-content]")?"Enter"==n?1==(e=a.find("li")).length&&qc.selector.select({contrl:a,curr:e,ev:t}):"ArrowDown"==n?(e=a.find("li"))[0]&&e.focus():"ArrowUp"!=n&&qc.selector.show({contrl:a,curr:r,ev:t}):r.is("li")&&("ArrowDown"==t.key?(c=r.next())[0]&&c.focus():"ArrowUp"==t.key?((c=r.prev())[0]?c:a.find("[qc-content")).focus():"Enter"==t.key&&r.click())}},qc.c.colorpicker={control:"colorpicker",show:function(t){var t=t.curr,e=t.attr("qc-colorpicker-mode"),c=t.attr("qc-colorpicker-css")||"color",a=t.attr("qc-target")?qc(t.attr("qc-target")):t,r=a.css(c);qc.colorpicker.dyShow(t,r,e,function(t){a.css(c,t)})},dyShow:function(t,e,c,a){qc.popfrm.dyShow(qc.lang.colorpicker.title,[{name:"ok",fn:"qc.colorpicker.confirm"}],"",t,function(t){t[0].callee=a,t.addClass("qc-colorpicker");t=t.find("[qc-content]");qc.colorpicker.createContent(t,e,c,a)})},createContent:function(t,e,c,a){"panel"==(c=c||(qc.util.mobile?"list":"panel"))&&(qc.colorpicker.createPanel(t),qc.colorpicker.initContent(t,e)),"list"==c&&qc.colorpicker.createList(t,e)},createPanel:function(t){t.css("padding",0),t.append("<div class='qc-colorpicker-panel'>   <canvas width='256' height='126'></canvas>   <div class='qc-colorpicker-panel-pick'></div> </div><div class='qc-colorpicker-bar'>   <div class='qc-colorpicker-cur'></div>   <canvas width='160' height='12' class='qc-colorpicker-color'></canvas>   <div class='qc-colorpicker-bar-pick'></div>    <div style='width: 160px; height: 12px;' class='qc-colorpicker-a-back'></div>   <canvas width='160' height='12' class='qc-colorpicker-a'></canvas>   <div class='qc-colorpicker-bar-pick-a'></div> </div><div class='qc-colorpicker-textbox'>   <div><input type='text' class='qc-colorpicker-hex'></div>   <div>HEX</div>   <div>       <input type='text' class='qc-colorpicker-rgb'>       <input type='text' class='qc-colorpicker-rgb'>       <input type='text' class='qc-colorpicker-rgb'>       <input type='text' class='qc-colorpicker-rgb'>   <div>       <div class='qc-colorpicker-rgb-text'>R</div>       <div class='qc-colorpicker-rgb-text'>G</div>       <div class='qc-colorpicker-rgb-text'>B</div>       <div class='qc-colorpicker-rgb-text'>A</div></div></div>"),t.find(".qc-colorpicker-panel")[0].onselectstart=function(){return!1},t.find(".qc-colorpicker-bar")[0].onselectstart=function(){return!1}},initContent:function(e,t){qc.colorpicker.drawBar(e),t=t&&"transparent"!=t?t:"rgba(0,0,0,0)",e[0].rgba=qc.colorpicker.str2rgba(t);t=e.find(".qc-colorpicker-panel"),qc.colorpicker.event(t,qc.colorpicker.setPanelPickP),t=e.find(".qc-colorpicker-bar");qc.colorpicker.event(t,qc.colorpicker.setBarPickP),e.find(".qc-colorpicker-hex, .qc-colorpicker-rgb").change(function(t){var c;qc(this).is(".qc-colorpicker-hex")&&(e[0].rgba=qc.colorpicker.str2rgba(this.value)),qc(this).is(".qc-colorpicker-rgb")&&(c=[],e.find(".qc-colorpicker-rgb").each(function(t){var e=this.value.trim();0==e.length&&(e=0),c[t]=e}),e[0].rgba.r=c[0],e[0].rgba.g=c[1],e[0].rgba.b=c[2],e[0].rgba.a=c[3]),qc.colorpicker.setBarPick(e),qc.colorpicker.setPanelPick(e),qc.colorpicker.setTextBox(e)}),qc.colorpicker.setBarPick(e),qc.colorpicker.setPanelPick(e),qc.colorpicker.setTextBox(e)},drawBar:function(t){var e=["#f00","#f0f","#00f","#0ff","#0f0","#ff0","#f00"],t=t.find(".qc-colorpicker-color"),c=t.width(),a=t.height(),t=t[0].getContext("2d"),r=t.createLinearGradient(1,0,c-1,0),n=e.length-1;e.each(function(t,e){r.addColorStop(e/n,t)}),t.fillStyle=r,t.fillRect(0,0,c,a)},event:function(a,r){a.on("mousedown",function(t){var e=qc(t.target);function c(t){r(a,t.pageX,t.pageY),t.preventDefault()}(e.hasClass("qc-colorpicker-bar-pick")||e.hasClass("qc-colorpicker-bar-pick-a")||e.hasClass("qc-colorpicker-panel-pick")||e.is("canvas"))&&(a.tar=e,r(a,t.pageX,t.pageY),qc(document).on("mousemove",c,!1),qc(document).on("mouseup mouseleave",function t(e){qc(document).off("mousemove",c,!1);qc(document).off("mouseup",t,!1)},!1))})},setPanelPickP:function(t,e,c){var a=t.find(".qc-colorpicker-panel-pick"),e=e-t.offset().left,c=c-t.offset().top,r=t.find("canvas"),n=r[0].width,i=r[0].height,t=t.closest("[qc-content]"),e=Math.max(0,Math.min(e,n)),c=Math.max(0,Math.min(c,i)),o=t[0].rgba,d=200<=o.r&&200<=o.g&&200<=o.b?"#000":"#fff",a=(a.css({left:e-a.width()/2+"px",top:c-a.height()/2+"px","box-shadow":"0 0 2px 2px "+d}),r[0].hsba);a.s=100*e/n,a.b=100-100*c/i,a.a=o.a,t[0].rgba=qc.colorpicker.hsba2rgba(a),qc.colorpicker.setTextBox(t)},setBarPickP:function(t,e,c){var a,r=t.tar,n=!1,r=(r.hasClass("qc-colorpicker-color")||r.hasClass("qc-colorpicker-bar-pick")?a=t.find(".qc-colorpicker-bar-pick"):(a=t.find(".qc-colorpicker-bar-pick-a"),n=!0),t.find("canvas").eq(n?1:0)),e=e-t.offset().left,i=r[0].width,t=t.closest("[qc-content]"),e=Math.max(r[0].offsetLeft,Math.min(e,i+r[0].offsetLeft));a.css({left:e-a.width()/2+"px"}),n?(a=((e-r[0].offsetLeft)/i).toFixed(2),t[0].rgba.a=a=1==(a=0==a?0:a)?1:a):((n=qc.colorpicker.rgba2hsba(t[0].rgba)).h=360-360*(e-r[0].offsetLeft)/i,t[0].rgba=qc.colorpicker.hsba2rgba(n),qc.colorpicker.drawPanel(t,n)),qc.colorpicker.setTextBox(t)},setBarPick:function(t){var e=t.find(".qc-colorpicker-bar-pick"),c=t.find(".qc-colorpicker-bar-pick-a"),a=t.find(".qc-colorpicker-bar canvas"),r=a[0].width,n=a[0].offsetLeft,i=qc.colorpicker.rgba2hsba(t[0].rgba),r=(360-i.h)/360*r+n-e.width()/2,a=a[1].width/255*(255*i.a)+n-c.width()/2;qc.colorpicker.drawPanel(t,i),e.css("left",r+"px"),c.css("left",a+"px")},drawPanel:function(t,e){var c=t.find(".qc-colorpicker-panel canvas"),a=c[0].getContext("2d"),r=c[0].width,n=c[0].height,i=(e.s=100,e.b=100,e.a=1,qc.colorpicker.hsba2rgba(e)),o=qc.colorpicker.rgba2str(i),c=(c[0].hsba=e,a.createLinearGradient(3,0,r-3,0)),e=(c.addColorStop(0,"#fff"),c.addColorStop(1,o),a.fillStyle=c,a.fillRect(0,0,r,n),a.createLinearGradient(0,3,0,n-3)),o=(e.addColorStop(0,"rgba(0, 0, 0, 0)"),e.addColorStop(1,"rgba(0, 0, 0, 1)"),a.fillStyle=e,a.fillRect(0,0,r,n),t.find(".qc-colorpicker-a")),c=o[0].getContext("2d"),e=(c.clearRect(0,0,r,n),c.createLinearGradient(1,0,o[0].width-1,0)),a="rgba("+i.r+","+i.g+","+i.b+", 0)",t="rgba("+i.r+","+i.g+","+i.b+", 1)";e.addColorStop(0,a),e.addColorStop(1,t),c.fillStyle=e,c.fillRect(0,0,r,n)},setPanelPick:function(t){var e=t.find(".qc-colorpicker-panel canvas"),c=t.find(".qc-colorpicker-panel-pick"),a=e[0].width,e=e[0].height,t=t[0].rgba,r=qc.colorpicker.rgba2hsba(t),a=parseInt(r.s*a/100-c.width()/2),r=parseInt((100-r.b)*e/100-c.height()/2);c.css({left:a+"px",top:r+"px","box-shadow":"0 0 2px 2px "+(200<=t.r&&200<=t.g&&200<=t.b?"#000":"#fff")})},setTextBox:function(t){var e=t.find(".qc-colorpicker-cur"),c=t.find(".qc-colorpicker-hex"),a=t.find(".qc-colorpicker-rgb"),t=t[0].rgba,r=(e.css("background",qc.colorpicker.rgba2str(t)),c.val(qc.colorpicker.rgba2str(t,"hex")),[t.r,t.g,t.b]);a.each(function(t){qc(this).val(r[t])});t.a,t.a,a.eq(3).val(t.a)},str2rgba:function(a){a=a.replace(/\s+/g,"");var r={r:0,g:0,b:0,a:1};return[/^#([\da-fA-F]{2})([\da-fA-F]{2})([\da-fA-F]{2})([\da-fA-F]{2})?$/i,/^rgb\((\d{0,3}),(\d{0,3}),(\d{0,3})\)$/i,/^rgba\((\d{0,3}),(\d{0,3}),(\d{0,3}),([\d\.]+)\)$/i].each(function(t,e){var c,t=a.match(t);if(t)return c=[t[1],t[2],t[3]].map(function(t){return parseInt(1<e?t:"0x"+(1==t.length?t+t:t))}),r.r=c[0],r.g=c[1],r.b=c[2],t[4]&&(r.a=0==e?parseFloat((parseInt("0x"+t[4])/255).toFixed(2)):t[4]),!1}),r},rgba2hsba:function(t){var e,c=t.r,a=t.g,r=t.b,n=0,i=Math.min(c,a,r),o=Math.max(c,a,r),i=o-i,d=o,n=0!=(e=0!=o?255*i/o:0)?c==o?(a-r)/i:a==o?2+(r-c)/i:4+(c-a)/i:0;return(n*=60)<0&&(n+=360),{h:n,s:e*=100/255,b:d*=100/255,a:t.a}},hsba2rgba:function(t){var e,c,a,r,n=Math.round(t.h),i=Math.round(255*t.s/100),o=Math.round(255*t.b/100);return 0==i?e=c=a=o:(o=n%60*((r=o)-(i=(255-i)*o/255))/60,(n=360==n?0:n)<60?(e=r,c=(a=i)+o):n<120?(a=i,e=(c=r)-o):n<180?(c=r,a=(e=i)+o):n<240?(e=i,c=(a=r)-o):n<300?(a=r,e=(c=i)+o):a=n<360?(c=i,(e=r)-o):c=e=0),{r:Math.round(e),g:Math.round(c),b:Math.round(a),a:t.a}},rgba2str:function(t,e){var c=t.r,a=t.g,r=t.b,t=t.a;return"hex"==e?(e="#"+[c,a,r].map(function(t){return("0"+parseInt(t).toString(16)).slice(-2)}).join(""),1!=t&&(e+=Math.round("0"+255*t).toString(16).slice(-2)),e):(e=[c,a,r].join(","),1==t?"rgb("+e+")":"rgba("+e+","+t+")")},createList:function(r,t){var n=qc.colorpicker.str2rgba(t);[["#C00000","#ff0000","#FFC000","#ffff00","#92D050","#00B050","#00B0F0","#0070C0","#002060","#7030A0"],["#FFFFFF","#000000","#E7E6E6","#44546A","#4472C4","#ED7D31","#A5A5A5","#FFC000","#5B9BD5","#70AD47"],["#F2F2F2","#7F7F7F","#D0CECE","#D5DCE4","#D9E2F3","#FBE4D5","#EDEDED","#FFF2CC","#DEEAF6","#E2EFD9"],["#D9D9D9","#595959","#AEAAAA","#ACB9CA","#B4C6E7","#F7CAAC","#DBDBDB","#FFE599","#BDD6EE","#C5E0B3"],["#BFBFBF","#404040","#767171","#8496B0","#8EAADB","#F4B083","#C9C9C9","#FFD966","#9CC2E5","#A8D08D"],["#A6A6A6","#262626","#3B3838","#323E4F","#2F5496","#C45911","#7B7B7B","#BF8F00","#2E74B5","#538135"],["#808080","#0D0D0D","#171717","#222A35","#1F3864","#833C0B","#525252","#806000","#1F4E79","#385623"]].each(function(t,e){var a=qc("<div class='qc-colorpicker-row'>");t.each(function(t,e){var c=qc("<a href='javascript:void(0);' class='qc-colorpicker-box'>"),t=(c.css("background-color",t),qc.colorpicker.str2rgba(t));t.r==n.r&&t.g==n.g&&t.b==n.b&&1==n.a&&c.addClass("selected"),a.append(c),c.click(function(){var t=qc(this);r.find(".qc-colorpicker-box").removeClass("selected"),t.addClass("selected")})}),r.append(a)})},item:function(t){var e=t.curr.closest("[qc-content]")[0].callee,c=t.curr.css("background-color");e&&c&&(e(c),qc.popfrm.dyHide(t))},confirm:function(t){var e=t.contrl,c=(e[0].origin,e[0].callee),e=e.find("[qc-content]"),e=e[0].rgba?qc.colorpicker.rgba2str(e[0].rgba):e.find(".qc-colorpicker-box.selected").css("background-color");c&&c(e),qc.popfrm.hide(t)}},qc.c.datepicker={control:"datepicker",show:function(t){var r=t.curr,n=r.attr("qc-mode")||"date",i=r.attr("qc-target")?qc(r.attr("qc-target")):r,o=[{name:"ok",fn:"qc.datepicker.confirm"},{name:"cancel",fn:"qc.datepicker.hide"}],d="",l="";n.contains("nobar")&&(n=n.replace("nobar",""),o=""),n.contains("nocancel")&&(n=n.replace("nocancel",""),d=1),n.contains("timer")&&(n=n.replace("timer",""),l=1),n=n.replace(/\s+/g,"")||"date",qc.popfrm.dyShow(qc.lang.datepicker.title,o,"",r,function(t){var e=new Date,c=t.find("[qc-content]"),a=(c.css("padding",0),t.addClass("qc-datepicker"),r.val());a&&(a=a.replace(/[-\.]/gi,"/"),a=new Date(a),isNaN(a.getTime())||(e=a)),c[0].date=e,c[0].mode=n,c[0].target=i,c[0].bar=o?1:"",c[0].noCancel=d,qc.datepicker.createContent(c),qc.datepicker.format(c),l&&(c[0].refresh=qc.datepicker.refresh,c[0].refresh(c)),o||t.find("[qc-warp]").attr("qc-fn","qc.datepicker.confirm").removeAttr("qc-type")})},createContent:function(t){var e,c=t[0].mode,a=(["date","datetime"].contains(c)&&(a=qc("<div class='qc-datepicker-bar'>   <div class='qc-datepicker-ymbox'>       <span years qc-fn='qc.datepicker.ymShow'></span>   </div>   <div class='qc-datepicker-buttons'>       <span class='qc-datepicker-up' qc-fn='qc.datepicker.udpick'></span>       <span class='qc-datepicker-down' qc-fn='qc.datepicker.udpick'></span>   </div></div>"),t.append(a),qc.util.icon(a.find(".qc-datepicker-up"),"up"),qc.util.icon(a.find(".qc-datepicker-down"),"down"),a=qc("<div class='qc-datepicker-bar'>   <table class='qc-datepicker-dates'>       <tr><th></th><th></th><th></th><th></th><th></th><th></th><th></th></tr>       <tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>       <tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>       <tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>       <tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>       <tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>       <tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>   </table></div>"),t.append(a),a.find("tr").eq(0).find("th").each(function(t){var e=qc.lang.datepicker.weeks;qc(this).html(e[t])}),a.find("td").attr("qc-fn","qc.datepicker.datepick")),qc("<div class='qc-datepicker-bar times'>"));t.append(a),["datetime","time"].contains(c)&&(e=qc("   <span class='qc-datepicker-hour' qc-fn='qc.datepicker.hmsShow'></span> :    <span class='qc-datepicker-minute' qc-fn='qc.datepicker.hmsShow'></span> :    <span class='qc-datepicker-second' qc-fn='qc.datepicker.hmsShow'></span> "),a.append(e)),["datetime","date","time"].contains(c)&&(e=qc(("time"!=c?"   <span class='qc-datepicker-today' qc-fn='qc.datepicker.today'>"+qc.lang.datepicker.today+"</span>":"")+(t[0].noCancel?"":"   <span class='qc-datepicker-cancel' qc-fn='qc.datepicker.cancel'>"+qc.lang.datepicker.cancel+"</span>")),a.append(e)),["date","datetime"].contains(c)&&(t=qc("<div class='qc-datepicker-ympicker'>   <table>       <tr><td></td><td></td><td></td><td></td></tr>       <tr><td></td><td></td><td></td><td></td></tr>       <tr><td></td><td></td><td></td><td></td></tr>       <tr><td></td><td></td><td></td><td></td></tr>   </table></div>"),a.before(t),t.find("td").attr("qc-fn","qc.datepicker.ympick")),["datetime","time"].contains(c)&&(e=qc("<div class='qc-datepicker-hpicker'>   <table>       <tr><td></td><td></td><td></td><td></td><td></td><td></td></tr>       <tr><td></td><td></td><td></td><td></td><td></td><td></td></tr>       <tr><td></td><td></td><td></td><td></td><td></td><td></td></tr>       <tr><td></td><td></td><td></td><td></td><td></td><td></td></tr>   </table></div>"),t=qc("<div class='qc-datepicker-mspicker'>   <table>       <tr><td></td><td></td><td></td><td></td><td></td><td></td></tr>       <tr><td></td><td></td><td></td><td></td><td></td><td></td></tr>       <tr><td></td><td></td><td></td><td></td><td></td><td></td></tr>       <tr><td></td><td></td><td></td><td></td><td></td><td></td></tr>       <tr><td></td><td></td><td></td><td></td><td></td><td></td></tr>       <tr><td></td><td></td><td></td><td></td><td></td><td></td></tr>       <tr><td></td><td></td><td></td><td></td><td></td><td></td></tr>       <tr><td></td><td></td><td></td><td></td><td></td><td></td></tr>       <tr><td></td><td></td><td></td><td></td><td></td><td></td></tr>       <tr><td></td><td></td><td></td><td></td><td></td><td></td></tr>   </table></div>"),"time"==c?a.after(e).after(t):a.before(e).before(t),e.find("td").each(function(t){qc(this).attr("qc-fn","qc.datepicker.hmspick").attr("v",t).html(t)}),t.find("td").each(function(t){qc(this).attr("qc-fn","qc.datepicker.hmspick").attr("v",t).html(t)}))},format:function(t){qc.datepicker.formatym(t),qc.datepicker.formatDates(t),qc.datepicker.formatTimes(t),qc.datepicker.layout(t,0)},formatym:function(t){var e,c,a,r=t[0].mode;["date","datetime"].contains(r)&&(r=t[0].date,e=r.getFullYear(),c=r.getMonth(),r=qc.lang.datepicker.years,a=qc.lang.datepicker.months,r=r.split("/").map(function(t){return t.contains("m")?"<span month='"+c+"' qc-fn='qc.datepicker.ymShow'>"+t.replace(/m/,a[c])+"</span>":t.contains("y")?"<span year='"+e+"' qc-fn='qc.datepicker.ymShow'>"+t.replace(/y/,e)+"</span>":void 0}).join(""),(t=t.find(".qc-datepicker-ymbox")).find("[year], [month]").remove(),t.append(r),t.find("[years]").hide(),t.find("[year]").show(),t.find("[month]").show())},formatDates:function(t){var e=t[0].mode;if(["date","datetime"].contains(e)){var e=t[0].date,c=e.getFullYear(),a=e.getMonth(),e=new Date(c,a+1,1),r=(e.setDate(e.getDate()-1),e.getDate()),n=1,i=new Date(c,a,n).getDay(),e=(0==i&&(i=7),new Date(c,a,1)),o=(e.setDate(e.getDate()-1),e.getDate()),e=t.find(".qc-datepicker-dates"),d=(e.find("td").removeClass("other"),e.find("tr")),l=1;if(1<i){var s,q=i-2,f=c,p=a;for(-1==(p-=1)&&(f--,p=11);1==l;)if((s=d.eq(l).find("td").eq(q)).attr("year",f).attr("month",p).attr("date",o),s.addClass("other").html(o),o--,--q<0)break}for(;n<=r;)(s=d.eq(l).find("td").eq(i-1)).attr("year",c).attr("month",a).attr("date",n),s.html(n),n++,7<++i&&(l++,i=1);for(f=c,p=a,12==(p+=n=1)&&(f++,p=0);l<7;)(s=d.eq(l).find("td").eq(i-1)).attr("year",f).attr("month",p).attr("date",n),s.addClass("other").html(n),n++,7<++i&&(l++,i=1);qc.datepicker.date(t)}},formatTimes:function(t){var e,c,a=t[0].mode;["time","datetime"].contains(a)&&(e=(a=t[0].date).getHours(),c=a.getMinutes(),a=a.getSeconds(),e=("0"+e).slice(-2),c=("0"+c).slice(-2),a=("0"+a).slice(-2),t.find(".qc-datepicker-hour").attr("hour",e).html(e),t.find(".qc-datepicker-minute").attr("minute",c).html(c),t.find(".qc-datepicker-second").attr("second",a).html(a))},date:function(t){var e=t[0].date,c=new Date,a=e.getFullYear(),r=e.getMonth(),e=e.getDate(),t=t.find(".qc-datepicker-dates");t.find("td.picked, td.today").removeClass("picked today");t.find("td[year='"+a+"'][month='"+r+"'][date='"+e+"']").addClass("picked");a=t.find("td[year='"+c.getFullYear()+"'][month='"+c.getMonth()+"'][date='"+c.getDate()+"']");0<a.length&&a.addClass("today")},refresh:function(t){var e,c,a=t[0].refresh;a&&(e=new Date,null!=(c=t[0].date))&&(c.setHours(e.getHours()),c.setMinutes(e.getMinutes()),c.setSeconds(e.getSeconds()),t[0].date=c,qc.datepicker.formatTimes(t),qc.datepicker.date(t),setTimeout(function(){a(t)},1e3))},ymShow:function(t){var e,c=t.curr,t=t.contrl.find("[qc-content]"),a=t.find(".qc-datepicker-ymbox"),r=t.find(".qc-datepicker-ympicker"),n=a.find("[years]"),i=a.find("[year]"),a=a.find("[month]");r.isShow()?(r.hide(),qc.datepicker.layout(t,0),qc.datepicker.formatym(t)):(e=c.attr("year"),c=c.attr("month"),a.hide(),e?(i.hide(),n.show(),qc.datepicker.yShow(e,n,r)):c&&(n.hide(),i.show(),qc.datepicker.mShow(c,r)),qc.datepicker.layout(t,1),r.show())},yShow:function(e,t,c){var a=parseInt(e.slice(0,-1)+"0"),r=a-3;t.html(a+"-"+(a+9)).attr("s0",a),c.find("td").each(function(){var t=qc(this).removeClass("picked other");t.removeAttr("month").html(r),t.attr("year",r),(r<a||a+9<r)&&t.addClass("other"),r==parseInt(e)&&t.addClass("picked"),r++})},mShow:function(e,t){var c=0;t.find("td").each(function(){var t=qc(this).removeClass("picked other");t.removeAttr("year"),t.attr("month",c),11<c?(t.addClass("other"),t.html(c+1-12)):t.html(c+1),c==parseInt(e)&&t.addClass("picked"),c++})},ympick:function(t){var e=t.curr,t=t.contrl.find("[qc-content]"),c=t.find(".qc-datepicker-ympicker"),a=e.attr("year"),e=e.attr("month"),r=t[0].date;a?r.setFullYear(a):e&&(r.setFullYear(t.find(".qc-datepicker-ymbox [year]").attr("year")),r.setMonth(e)),t[0].date=r,qc.datepicker.format(t),c.hide()},datepick:function(t){var e=t.curr,t=t.contrl.find("[qc-content]"),c=e.attr("year"),a=e.attr("month"),e=e.attr("date"),r=t[0].date;r.setFullYear(c),r.setMonth(a),r.setDate(e),t[0].date=r,qc.datepicker.date(t)},udpick:function(t){var e,c,a,t=t.curr,r=t.closest("[qc-content]"),n=r.find(".qc-datepicker-ymbox"),i=r.find(".qc-datepicker-ympicker"),o=n.find("[years]"),d=n.find("[year]"),n=n.find("[month]"),l=0;t.is(".qc-datepicker-up")&&(l=-1),t.is(".qc-datepicker-down")&&(l=1),i.isShow()?o.isShow()?(a=parseInt(o.attr("s0"))+10*l,qc.datepicker.yShow(a+"",o,i)):(a=parseInt(d.attr("year"))+l,d.attr("year",a),d.html(d.html().replace(/\d+/gi,a))):(c=e="",qc.lang.datepicker.years.split("/").each(function(t){t.contains("m")?e=t:t.contains("y")&&(c=t)}),a=parseInt(n.attr("month"))+l,(t=r[0].date).setMonth(a),o=(r[0].date=t).getFullYear(),i=t.getMonth(),n.attr("month",i),n.html(e.replace(/m/,qc.lang.datepicker.months[i])),d.attr("year",o),d.html(c.replace(/y/,o)),qc.datepicker.formatDates(r))},today:function(t){t=t.curr.closest("[qc-content]");t[0].date=new Date,qc.datepicker.format(t),t[0].bar?t[0].refresh||(t[0].refresh=qc.datepicker.refresh,t[0].refresh(t)):qc.datepicker.confirm({contrl:t.closest("[qc-control]")})},cancel:function(t){t.curr.closest("[qc-content]")[0].date=void 0,qc.datepicker.confirm(t)},hmsShow:function(t){var e=t.curr,c=e.closest("[qc-content]"),a=c[0].date,r=e.attr("hour"),n=e.attr("minute"),e=e.attr("second"),r=r?"hour":n?"minute":e?"second":"",n=c.find(".qc-datepicker-hpicker"),e=c.find(".qc-datepicker-mspicker");(t="hour"==r?n:e).isShow()&&t.attr("picker")==r?(t.removeAttr("picker"),t.hide(),qc.datepicker.layout(c,0)):(n.hide(),e.hide(),"hour"==r?value=a.getHours():"minute"==r?value=a.getMinutes():"second"==r&&(value=a.getSeconds()),null!=value&&(t.find("td.picked").removeClass("picked"),t.find("td[v='"+value+"']").addClass("picked"),t.attr("picker",r).show(),qc.datepicker.layout(c,r)))},hmspick:function(t){var t=t.curr,e=t.attr("v"),t=t.closest("[picker]"),c=t.attr("picker"),a=t.closest("[qc-content]"),r=a[0].date;"hour"==c?r.setHours(e):"minute"==c?r.setMinutes(e):"second"==c&&r.setSeconds(e),a[0].date=r,a[0].refresh=void 0,qc.datepicker.formatTimes(a),t.removeAttr("picker"),t.hide(),qc.datepicker.layout(a,0)},confirm:function(t){var e=t.contrl.find("[qc-content]"),c=e[0].target,e=qc.datepicker.formatDate(e[0].date,e[0].mode);null!=c[0].value?c.val(e):c.html(e),c.change(),qc.datepicker.hide(t)},formatDate:function(t,e){var c,a,r,n,i;return t?(c=t.getFullYear(),a=("0"+(t.getMonth()+1)).slice(-2),r=("0"+t.getDate()).slice(-2),n=("0"+t.getHours()).slice(-2),i=("0"+t.getMinutes()).slice(-2),t=("0"+t.getSeconds()).slice(-2),"datetime"==e?c+"-"+a+"-"+r+" "+n+":"+i+":"+t:"time"==e?n+":"+i+":"+t:c+"-"+a+"-"+r):""},layout:function(t,e){var c,a,r,n,i,o=t.find(".qc-datepicker-bar"),d=t.find(".qc-datepicker-bar times");1==o.length?n=(i=(d=o.eq(0)).next()).next():(c=o.eq(0),a=o.eq(1),d=o.eq(2),i=(n=(r=o.eq(1).next()).next()).next()),d.find("[hour], [minute], [second]").removeClass("selected"),0==e?(n.hide(),i.hide(),c&&(o.show(),r.hide(),o=a.contents("table"),r.find("table").width(o.width()),r.find("table").height(o.height()),n.find("table").width(o.width()),n.find("table").height(c.height()+a.height()),i.find("table").width(o.width()),i.find("table").height(c.height()+a.height()))):1==e?(n.hide(),i.hide(),d.hide(),c&&(c.show(),a.hide(),r.show())):(d.show(),i.hide(),c&&(c.hide(),a.hide(),r.hide()),"hour"==e?(n.show(),i.hide()):(n.hide(),i.show()),d.find("["+e+"]").addClass("selected"),qc.popfrm.layout(t.closest("[qc-control]")))},hide:function(t){t.contrl.find("[qc-content]")[0].refresh=void 0,qc.popfrm.hide(t)}},qc.c.lister={control:"lister",create:function(t){t.find("[qc-content]").hide(),t.find("[qc-toolbar]").remove(),qc.lister.createBar(t),t.find("ul")[0]||t.append("<ul>");var e=t.attr("qc-fn"),e=(e&&(t[0].callback=qc.util.convert2fnc(e)),t.attr("qc-page")),c=t.attr("qc-count");e||t.attr("qc-page",1),c||t.attr("qc-count",20)},createBar:function(t){var a,e=t.attr("qc-buttons");e&&(a=qc("<div class='qc-toolbar' qc-toolbar></div>"),t.prepend(a),e.split(",").each(function(t){var e,t=t.split("|"),c=qc("<a href='javascript:void(0);' qc-type='view'></a>");a.append(c),t[1]&&(e=2<t.length?t.slice(2):[],qc.util.lang(c,t[1],e.join(",")),c.prepend("&nbsp;"),c.attr("qc-type",["view","list"].contains(t[1])?"view":t[1])),t[0]&&qc.util.icon(c,t[0])}))},init:function(){qc.lister.getDatas()},getDatas:function(){qc("[qc-control='lister']").each(function(){var t=qc(this),e=t.attr("qc-mode")||"auto";qc.lister.setView(t,0),"auto"==e&&qc.lister.get(t)})},get:function(t,e,c){(e=e||{}).page=t.attr("qc-page")||1,e.count=t.attr("qc-count")||20,qc.util.get(t,e,function(t,e){e.contrl[0].data=t,qc.lister.fill(t,e,c)})},fill:function(t,e,c){var a,r=e.contrl,n=r.attr("qc-field"),i=r.find("[qc-content]"),o=r.find("[qc-toolbar] a.selected");if(i[0]){a=i.eq(o[0]?o.index():0),o[0]&&(a=i.eq(o.index()));var d=r.find("ul");d.empty();for(var l=0;l<t.rows;l++){var s=t.data[l],q=qc("<li>");qc.lister.content(a,n,q,s),d.append(q)}i=r.attr("qc-for"),o=(i&&qc.pagepicker.show(qc(i),r,t.pages),c||r[0].callback);o&&"function"==typeof o&&o(t,e)}},content:function(t,e,c,a){var r,n=t.clone(),t=n.attr("class");for(r in c.addClass(t||""),c.attr("qc-field",e),c.attr("qc-value",a[e]),a){var i=n.find("[qc-field='"+r+"']");i[0]&&(null!=i[0].value?i.val(a[r]):i.attr("qc-value",a[r]).html(a[r]))}c.append(n.contents())},setView:function(t,e){e=e||0;t=t.find("[qc-toolbar] a");t.removeClass("selected"),t.eq(e).addClass("selected")},view:function(t){var e=t.curr,c=t.contrl,e=e.index();qc.lister.setView(c,e),t.args={},qc.lister.fill(c[0].data,t)}},qc.c.pagepicker={control:"pagepicker",create:function(t){t.hide(),t.addClass("qc-pagepicker")},show:function(t,e,c){t[0].origin=e,t.empty();var a=e.attr("qc-page")||0,e=e.attr("qc-count")||0,r=t.attr("qc-count")||10;if(0!=a||0!=e){var n=parseInt(a),i=parseInt(r),o=Math.floor((n-1)/i)*i+1;i<n&&qc.pagepicker.setPage(t,o-1,"&lt;",n);for(var d=0;d<i&&!(c<o);d++)qc.pagepicker.setPage(t,o,o,n),o++;o<c&&qc.pagepicker.setPage(t,o,"&gt;",n),t.show()}},setPage:function(t,e,c,a){var r=qc("<li qc-type='page'>");r.attr("qc-value",e).html(c),a==e&&r.addClass("selected"),t.append(r)},page:function(t){var e=qc(t.contrl[0].origin),c=e.attr("qc-control"),c=qc[c];e.attr("qc-page",t.curr.attr("qc-value")),c.get(e)}},qc.c.editor={control:"editor",create:function(t){t[0].mode=QCSet(),t[0].pos="static";var e=t.attr("qc-mode")||"auto",e=(e&&(e.contains("auto")?t[0].mode.add("get","post"):(e.contains("get")&&t[0].mode.add("get"),e.contains("post")&&t[0].mode.add("post")),e.contains("fixed"))&&(t[0].pos="fixed",t.css("position","absolute"),t.hide()),t.find("[qc-field]").each(function(){var t=qc(this),e=t.attr("qc-mode");e&&t.bind(e,function(){qc.editor.verify(qc(this))})}),qc.editor.hideMsg(t),t.attr("qc-fn"));e&&(t[0].callback=qc.util.convert2fnc(e)),t[0].mode.contains("get")&&qc.editor.get(t,{})},show:function(t){var e=qc(t.curr.attr("qc-target")),c={};e[0].orEl=t.curr[0],qc.util.getVal(t.curr,c),qc.editor.get(e,c),"fixed"==e[0].pos&&(e.show(),qc.util.hideObj.set(e))},get:function(t,e,c){e=e||{},qc.util.get(t,e,function(t,e){qc.editor.fill(t,e,c)})},fill:function(t,e,c){var a=e.contrl;if(qc.editor.hideMsg(a),0==t.rows)qc.util.initData(a);else for(var r=0;r<t.rows;r++){var n=t.data[r];qc.util.setDatas(a,n)}c=c||a[0].callback;c&&"function"==typeof c&&c(t,e)},change:function(t,e){var c=t.contrl,t=t.curr,a=!0,r=c.equals(t);r?c.find("[qc-field]").each(function(){var t=qc(this);a=qc.editor.verify(t)&&a}):a=qc.editor.verify(t),a&&(c[0].mode.contains("post")||r)&&qc.editor.post(t,{},e)},submit:function(t,e){t.curr=t.contrl,qc.editor.change(t,e)},post:function(t,e,c){qc.util.post(t,e,function(t,e){qc.editor.fill(t,e,c)})},verify:function(t){var e=[],c=(t.contrl?t.contrl.find("[qc-field]").each(function(){e.push(qc(this))}):e.push(t),!0);return e.each(function(t){var e=t.attr("qc-rule");if(!e)return!0;var n,e=e?e.split(" "):[],i=qc.util.getVal(t),o=!0;e.each(function(t){if("number"==t)o=o&&/^-?[1-9]?\d*(\.\d{0,2})?$/.exec(i);else if("date"==t)try{var e=new Date(i);o=o&&!isNaN(e.getTime())}catch(t){}else if("notnull"==t)o=o&&0<i.length;else if(n=/^maxlen\((\d+)\)$/.exec(t)){for(var c=0,a=0;a<i.length;a++){var r=i.charCodeAt(a);0<=r&&r<=128?c++:c+=2}o=o&&c<=n[1]}else(n=/^format\(([^\)]+)\)$/.exec(t))&&(e=new RegExp(n[1],"gi"),o=o&&e.exec(i))}),qc.editor.showMsg(t,o),c=c&&o}),c},showMsg:function(t,e){var c=qc(t.attr("qc-success")),t=qc(t.attr("qc-failure"));c.hide(),t.hide(),(e?c:t).show()},hideMsg:function(t){t.is("[qc-control]")?t.find("[qc-field]").each(function(){qc(qc(this).attr("qc-success")).hide(),qc(qc(this).attr("qc-failure")).hide()}):(qc(t.attr("qc-success")).hide(),qc(t.attr("qc-failure")).hide())}},qc.c.treeview={control:"treeview",create:function(t){var e=t.attr("qc-mode")||"auto",c=(t[0].mode=e,t.attr("qc-fn")),c=(c&&(t[0].callback=qc.util.convert2fnc(c)),t.find("[qc-content]"));c.hide(),t[0].qc_pKey=c.attr("qc-pKey"),t[0].qc_key=c.attr("qc-key"),t[0].qc_val=c.attr("qc-value"),t.attr("qc-get")&&e.contains("auto")&&qc.treeview.get(t)},get:function(t,e,c){(e=e||{})[t[0].qc_pKey]=t[0].qc_val,qc.util.get(t,e,function(t,e){qc.treeview.fill(t,e,c)})},fill:function(t,e,c){var a=e.contrl,r=a.contents("[qc-content]"),n=a.find("[qc-key='"+a[0].qc_val+"']"),i=parseInt(a.attr("qc-levels")),o=(n=n[0]?n:a).contents("ul").empty(),d=!1;o[0]||(o=qc("<ul>"),n.append(o)),!isNaN(i)&&0<i&&(d=o.parents("ul").length+1==i);for(var l=0;l<t.rows;l++){var s,q=t.data[l];(s=qc("<li>"))[0].limit=d,qc.treeview.content(r,s,q),o.append(s)}r.contents("[qc-type='addNew']")[0]&&(i=n.attr("qc-key")||"",s=qc("<li qc-pKey='"+i+"'>"),qc.treeview.content(r,s),o.append(s));n=c||a[0].callback;n&&"function"==typeof n&&n(t,e)},content:function(t,e,c){var a=t.clone(),r=a.attr("class"),n=t.attr("qc-key"),t=t.attr("qc-pKey");e.addClass(r||""),e.attr("qc-field",n),c?(e.attr("qc-key",c[n]),e.attr("qc-pKey",c[t]),e.append(a.contents()),qc.util.setDatas(e,c),qc.treeview.caretShow(e,"expand")):(r=a.contents("[qc-type='addNew']"))[0]&&(e.append(r),r.removeAttr("qc-type"),r.show())},caretShow:function(t,c){t.contents("[qc-type]").each(function(){var t=qc(this),e=t.attr("qc-type");c.contains(e)?t.show():t.hide()})},expand:function(t){var e=t.contrl,t=t.curr.closest("li");t[0].limit||(e[0].qc_val=t.attr("qc-key"),qc.treeview.get(e,{}),qc.treeview.caretShow(t,"collapse"))},setPKey:function(t){var e=t.contrl,t=t.curr.closest("ul").closest("li");e[0].qc_val=t[0]?t.attr("qc-key"):e.find("[qc-content]").attr("qc-value")},collapse:function(t){var e=t.curr.closest("li");e[0].limit||(e.contents("ul").remove(),qc.treeview.caretShow(e,"expand"),(e=e.parent().closest("li"))[0]?t.contrl[0].qc_val=e.attr("qc-key"):t.contrl[0].qc_val=t.contrl.find("[qc-content]").attr("qc-value"))},reload:function(t,e){var c=t.contrl,t=t.curr.parent().closest("li");t[0]?c[0].qc_val=t.attr("qc-key"):c[0].qc_val=c.find("[qc-content]").attr("qc-value"),qc.treeview.get(c,{},e)}},qc.c.sheet={control:"sheet",create:function(t){var e=t.attr("qc-mode")||"auto",c=t.attr("qc-get"),a=t.contents("table"),r=t.attr("qc-key"),r=(e&&(t[0].multi=e.contains("multiple"),e=e.contains("manual")?"":"auto"),t[0].qcKey=r,t.removeAttr("qc-key"),t.attr("qc-fn")),r=(r&&(t[0].callback=qc.util.convert2fnc(r)),a[0]||(a=qc("<table>"),t.append(a)),a.contents("thead")[0]||a.append("<thead>"),a.contents("tbody")[0]||a.append("<tbody>"),qc("<div qc-content>")),n=(t.append(r),qc.sheet.foot(t),qc.sheet.reLayout(t),qc("<div qc-warp>"));n.append(a),r.append(n),c&&e.contains("auto")?qc.sheet.get(t,{}):(r=[],qc.sheet.fromat(a,r),qc.sheet.layout(t),qc.sheet.pages({data:r,rows:r.length,count:r.length,pages:1,page:1},t))},foot:function(t){var e=qc("<div class='qc-sheet-foot' qc-foot>"),t=(t.append(e),qc("<span class='qc-sheet-page' qc-type='page' v='first'>")),t=(qc.util.icon(t,"first","sheet"),qc.util.lang(t,"first","title","sheet"),e.append(t),qc("<span class='qc-sheet-page' qc-type='page' v='left'>")),t=(qc.util.icon(t,"left","sheet"),qc.util.lang(t,"left","title","sheet"),e.append(t),qc("<input type='text' class='' v='page' qc-type='change' qc-fn='qc.sheet.page'>")),t=(qc.util.lang(t,"page","title","sheet"),e.append(t),e.append("<span>/</span><span v='pages'></span>"),qc("<span class='qc-sheet-page' qc-type='page' v='right'>")),t=(qc.util.icon(t,"right","sheet"),qc.util.lang(t,"right","title","sheet"),e.append(t),qc("<span class='qc-sheet-page' qc-type='page' v='last'>")),t=(qc.util.icon(t,"last","sheet"),qc.util.lang(t,"last","title","sheet"),e.append(t),qc("<span class='total'>")),c=qc("<span v='rows' class='total'>"),a=qc("<span class='total'>"),r=qc("<span v='count' class='total'>");qc.util.lang(t,"rows","html","sheet"),qc.util.lang(a,"total","html","sheet"),e.append(t).append(c).append(a).append(r)},reLayout:function(t){var e=t.find("[qc-foot]"),c=t.find("[qc-content]"),t=t.height(),e=e.outerHeight();c.css("height",t-e+"px")},fromat:function(t,e){var o=[];t.find("thead th").each(function(t){var e=qc(this),c=null!=e.attr("qc-fixed")?"fixed":"",t=e.attr("qc-field")||t,e=e.attr("qc-text")||"";o.push({fixed:c,field:t,text:e})}),t.find("tbody tr").each(function(){var i={};qc(this).find("td").each(function(t){var e=qc(this),t=o[t],c=(t.fixed&&e.attr("qc-fixed",""),e.attr("qc-field",t.field),e.attr("qc-value"));if(null==c){var a=e.html();if(t.text){var r,n=JSON.parse(text);for(r in n)if(n[r]==a){c=r;break}}e.attr("qc-value",c=c||a)}i[t.field]=c}),e.push(i)})},get:function(t,e,c){(e=e||{}).page=t.attr("qc-page")||1,e.count=t.attr("qc-count")||20,qc.util.get(t,e,function(t,e){qc.sheet.fill(t,e,c)})},fill:function(t,e,c){for(var a,r=e.contrl,n=(r[0].data=t,r.find(".qc-sheet-head-y, .qc-sheet-data-x, .qc-sheet-head-x, .qc-sheet-scroll").remove(),r[0].qcKey),i=r.find("[qc-content] table"),o=r[0].hideField,d=i.find("thead th").show(),l=(o&&(a=[],d.each(function(){var t=qc(this),e=t.attr("qc-field");o.contains(e)?t.hide():a.push(t)}),d=a),i.find("tbody").empty()),s=0;s<t.rows;s++){var q=t.data[s],f=qc("<tr>");f[0].b=q,n&&(f.attr("qc-field",n),f.attr("qc-value",q[n])),l.append(f),qc.sheet.fill_tr(f,d,q)}qc.sheet.pages(t,r);var p,i=c||r[0].callback;0!=(p=i?i(t,e):p)&&qc.sheet.layout(e.contrl)},fill_tr:function(t,e,c){for(var a=0;a<e.length;a++){var r=qc(e[a]),n=r.attr("qc-field"),i=null==r.attr("qc-fixed")?"":"qc-fixed",o=r.attr("qc-text"),r=r.attr("class")||"",d=c[n];o&&(d=JSON.parse(o)[d]),t.append("<td qc-field='"+n+"' qc-value='"+c[n]+"' "+i+" class='"+r+"'>"+d+"</td>")}},layout:function(t){var e=t.find("[qc-content]"),c=e.find("[qc-warp]"),a=c.find("table"),r=qc("<div class='qc-sheet-head-y'>"),n=qc("<div class='qc-sheet-data-x'>"),i=qc("<div class='qc-sheet-head-x'>"),o=qc("<div class='qc-sheet-scroll'>"),d=a.width(),l=c.width();a.width(d<l?l:d),e.append(r.append(a.clone())),e.append(n.append(a.clone())),e.append(i.append(a.clone())),e.append(o.append(a.clone())),t[0].warp=c,t[0].thead_y=r,t[0].data_x=n,t[0].thead_x=i,(t[0].scroll=o).off("click").on("click",qc.sheet.selected),o.off("scroll").on("scroll",qc.sheet.scroll)},scroll:function(t){var e=qc(this).closest("[qc-control]")[0];this.st!=this.scrollTop?(this.st=this.scrollTop,e.data_x[0].scrollTop=this.st,e.warp[0].scrollTop=this.st):(this.sl=this.scrollLeft,e.thead_y[0].scrollLeft=this.sl,e.warp[0].scrollLeft=this.sl)},pages:function(t,e){var c=parseInt(e.attr("qc-page"))||1,e=e.find("[qc-foot]"),a=t.pages||1;e.find(".qc-sheet-page").show(),e.find("[v='page']").val(c),e.find("[v='pages']").html(a),1==c&&(e.find("[v='first']").hide(),e.find("[v='left']").hide()),2==c&&e.find("[v='left']").hide(),c==a&&(e.find("[v='last']").hide(),e.find("[v='right']").hide()),c==a-1&&e.find("[v='right']").hide(),t.rows?e.find("[v='rows']").show().html(t.rows):e.find("[v='rows']").hide().html(""),t.count?e.find("[v='count']").show().html(t.count):e.find("[v='count']").hide().html("")},page:function(t){var e=t.curr,t=t.contrl,c=e.attr("v"),a=e.parent(),r=parseInt(a.find("[v='page']").val()),a=parseInt(a.find("[v='pages']").html());"left"==c?t.attr("qc-page",r-1):"right"==c?t.attr("qc-page",r+1):"first"==c?t.attr("qc-page",1):"last"==c?t.attr("qc-page",a):(e.val(r=a<r?a:r),t.attr("qc-page",r)),qc.sheet.get(t,{},t[0].callee)},selected:function(t){var e,c,a,n,r,i,o,d,l,s,q=t.pageX,f=t.pageY,t=qc(t.target).closest("[qc-control='sheet']");t[0]&&(e=t.find("[qc-warp]"),o=t[0].thead_x.offset().top,i=t[0].thead_x.find("thead").height(),c=t[0].data_x,s=e.find("tr"),a=t[0].multi,r=!1,i+o<=f&&s.each(function(){var t=qc(this),e=t.offset().left,c=e+t.width(),a=t.offset().top,r=a+t.height();if(e<=q&&q<=c&&a<=f&&f<=r)return n=t,!1}),n?(r=n.hasClass("selected"),i=n.index()+1,o=c.find("tr").eq(i),a?r?(n.removeClass("selected"),o.removeClass("selected")):(n.addClass("selected"),o.addClass("selected")):(e.find("tr").removeClass("selected"),c.find("tr").removeClass("selected"),r||(n.addClass("selected"),o.addClass("selected"))),r=!r):t.find("tr.selected").removeClass("selected"),t.attr("qc-post"))&&(d=[],l=[],e.find("tr.selected").each(function(){var t=qc(this),e=t.attr("qc-value");d.push(e),l.push(t[0].b)}),(s=n&&n[0].b?n[0].b:{}).key=t.attr("qc-key")||"",s._data=l,s._has=r,s.selected=d.join(","),qc.util.post(t,s))},setHide:function(t){for(var e=[],c=1;c<arguments.length;c++)e.push(arguments[c]);t[0].hideField=e},refresh:function(t){t.find("[qc-foot] input").change()}};